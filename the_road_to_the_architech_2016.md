架构师之路精选2016
====================  

#### 互联网架构，如何进行容量设计
* 常见的容量评估包括数据量、并发量、带宽、CPU/MEM/DISK等
* 容量评估的步骤与方法
  - 步骤一：评估总访问量（询问业务方）
    - 要做一个APP-push的运营活动，计划在30分钟内完成5000w用户的push推送，预计push消息点击率10%，求push落地页系统的总访问量？5000w*10% = 500w
  - 步骤二：评估平均访问量QPS（有了总量，除以总时间即可）
  - 步骤三：评估高峰QPS（根据业务特性，通过业务访问曲线评估）
  - 步骤四：评估系统、单机极限QPS（压力测试）

#### 数据库软件架构设计些什么
* 基本概念
  - 单库
  - 分片：解决数据量大的问题，分片引入数据路由问题
    - 路由方法：1）range；2）hash；3）router-config-server
  - 分组：解决可用性问题（主从复制）
* 数据库架构设计思路
  - 如何保证数据的可用性
    - 冗余，但会引发一致性问题
    - 读高可用：冗余读库
    - 写高可用：双主互备
  - 如何提高数据库读性能
    - 建立索引
    - 增加从库
    - 增加缓存
  - 如何保证一致性
    - 中间件
    - 强制读主
  - 如何提高扩展性

#### 如何实施异构服务器的负载均衡及过载保护
* 能否根据异构服务器的处理能力来动态、自适应进行负载均衡及过载保护，是本文要讨论的问题
* service层的负载均衡，一般是通过service连接池来实现的
* 通过“静态权重”标识service的处理能力
  - 为每个下游service设置一个“权重”，代表service的处理能力，来调整访问到每个service的概率
    - 优点：简单
    - 缺点：权重是固定的，无法自适应动态调整
* 通过“动态权重”标识service的处理能力
  - 每当service成功处理一个请求，权重动态+1
  - 每当service超时处理一个请求，权重动态-10
  - 权重的范围限定为[0, 100]，把权重的初始值设为60分
* 过载保护
  - 系统负载超过一个service的处理能力，service让能保证对外提供有损的稳定服务
  - 最简易的方式，服务端设定一个负载阈值，超过这个阈值的请求压过来，全部抛弃。
* 如何借助“动态权重”来实施过载保护



### 资料链接
* [2016精选](https://mp.weixin.qq.com/s?__biz=MjM5ODYxMDA5OQ==&mid=2651959886&idx=1&sn=03e45a5014053607eff5e55ed2c660d7&chksm=bd2d07928a5a8e8454d395e176fa9d346682abfe9dfbf3244f1dead83ee4508aa25121f9b811&scene=21#wechat_redirect)
* [容量规划+单点优化+配置优化](https://mp.weixin.qq.com/s?__biz=MjM5ODYxMDA5OQ==&mid=2651960436&idx=1&sn=c336b6160263bf5afa2e0aa47088861e&chksm=bd2d01a88a5a88be02af6ecf2b280b3c396b10061d39840ec6df14064fe212b3fc97951d3214&scene=25#wechat_redirect)  
