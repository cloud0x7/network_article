
架构师之路精选
====================

#### 互联网架构如何实现“高并发”
* 什么是高并发：通过设计保证系统能够同时并行处理很多请求
  - 相关指标：响应时间、吞吐量、QPS
* 如何提升并发能力
  - 垂直扩展（Scale Up）：业务发展前期建议使用（效果最快）
    - 提升单机处理能力：
      - 增强硬件：增加CPU数、升级网卡、升级硬盘、内存
      - 增强架构性能：缓存减少IO，异步增加吞吐量、无锁数据结构减少响应时间
  - 水平扩展(Scale Out)：终极方案
    - 常见互联网分层架构：客户端层、反向代理层、站点应用层、服务层、数据-缓存层、数据-数据库层
    - 分层水平扩展实践
      - 反向代理层：DNS轮询
      - 站点层：通过nginx实现，设置多个web后端
      - 服务层：通过服务连接池实现
      - 数据层：垂直拆分、水平拆分（按范围拆、按哈希拆）
        
#### TCP接入层的负载均衡、高可用、扩展性架构
* TCP是有状态的连接，一个client发起的请求必须落在同一台tcp-server上，如何做负载均衡，如何保证水平扩展呢
  - 单机法tcp-server：
    - 优点：请求一致性
    - 缺点：无法保证高可用
  - 集群法tcp-server，客户端实现负载均衡（配置多个外网IP，随机选择其一）
    - 优点：可保证高可用
    - 缺点：多一次DNS访问，难以预防DNS劫持
      - 改进：将IP配置在客户端（IP直通车）
        - 缺点：扩展性差，如IP变化、新增都需要更新客户端
  - 服务端实施负载均衡（根本上解决问题）
    - 增加一个http接口，将客户端的“IP配置”与“均衡策略”放到服务端，client每次访问tcp-server前，先调用一个新增的get-tcp-ip接口，这个http接口只返回一个tcp-server的IP
      - 优点：解决扩展性问题
      - 缺点：接口不知道tcp-server集群中每台服务器是否可用
  - tcp-server状态上报
    - 优点：解决上面问题
    - 缺点：反向依赖
  - tcp-server状态拉取
    - 优点：解决上面问题

  
  
### 资料链接
* [架构师之路精选](https://mp.weixin.qq.com/s/CIPosICgva9haqstMDIHag)